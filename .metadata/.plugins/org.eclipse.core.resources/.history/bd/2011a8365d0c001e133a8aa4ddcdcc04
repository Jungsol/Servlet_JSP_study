<%@page import="java.sql.SQLException"%>
<%@page import="java.sql.DriverManager"%>
<%@page import="java.sql.ResultSet"%>
<%@page import="java.sql.PreparedStatement"%>
<%@page import="java.sql.Connection"%>
<%@ page language="java" contentType="text/html; charset=EUC-KR"
    pageEncoding="EUC-KR"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
</head>
<body>
	<%
		String id = request.getParameter("id");
		String pw = request.getParameter("pw");
		
		// try~catch문 : 예외처리구문
		// try : 동작시키고싶은 코드 작성 / catch: 에러 발생시 catch로 이동함
		//finally문 : 무조건 실행하는 구문
		
		// 전역변수에서 작성해야 finally문에서 실행됨
		Connection conn = null; // 데이터베이스와 연결하는 객체
		PreparedStatement psmt = null; //db실행 시켜주는 객체 보안성이 높고 가독성이 좋다.
		ResultSet rs = null; // 보통 DB select 문에서 사용(실행된 결과를 받아오는 객체)
		
		final String driver = "org.mariadb.jdbc.Driver";
		final String DB_IP = "localhost";
		final String DB_PORT = "3306";
		final String DB_NAME = "JSP_study";
		final String DB_URL = "jdbc:mariadb://" + DB_IP + ":" + DB_PORT + "/" + DB_NAME;
		
		
		// DB연결관련
		try{
			//1. 드라이버 로드
			Class.forName(driver);
			//2. DB 연동
			conn = DriverManager.getConnection(DB_URL, "root", "1234");
			
			if(conn == null){
				out.print("DB연결실패");
			}else{
				out.print("연결성공!");
				response.sendRedirect("ex10result.jsp");
			}
		} catch (ClassNotFoundException e){
			// ojdbc6.jar파일이 없거나 Class경로가 잘못된 경우
			out.print("드라이버 로드 실패");
			e.printStackTrace();
		} catch (SQLException e){
			// DB연결 및 SQL관련 오류가 발생한 경우
			out.print("DB접속 실패 또는 SQL문장 확인");
			e.printStackTrace();
		}
		
		// 3. 쿼리문 실행
		try{
			String sql = "select * from test_member";
			
			psmt = conn.prepareStatement(sql); // ?가 있는 sql문 전송
			psmt.setString(1, id); //setString(?의 인덱스 1부터시작, 매개변수)
			psmt.setString(2, pw); 
			/* setString 예시
				String sql="select * from test_member where id = ? and pw = ?";
				psmt = conn.prepareStatement(sql);
				psmt.setString(1, id); // 첫번째 물음표
				psmt.setString(2, pw); // 두번째 물음표
			*/
			
			//여기까지 쿼리문 정의하는 단계
			
			
			
			
		}catch(){
			
		}
	
	
	%>














	
	<%
		String id = request.getParameter("id");
		String pw = request.getParameter("pw");
		
		if(id.equals("smart") && pw.equals("1234")){
			
			// 쿼리스트링 형식으로 데이터를 loginTrue.jsp로 전달
			response.sendRedirect("loginTrue.jsp?id="+id);
		}else{
			response.sendRedirect("loginFalse.jsp");
		}
	%>
	
</body>
</html>